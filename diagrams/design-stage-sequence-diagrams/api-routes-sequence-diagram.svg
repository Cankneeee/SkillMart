<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="2355px" preserveAspectRatio="none" style="width:1318px;height:2355px;background:#FFFFFF;" version="1.1" viewBox="0 0 1318 2355" width="1318px" zoomAndPan="magnify"><title>API Routes Sequence Diagram (Design Phase)</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="363.7471" x="478.2822" y="27.9951">API Routes Sequence Diagram (Design Phase)</text><rect fill="none" height="544" style="stroke:#000000;stroke-width:1.5;" width="1281.3115" x="20" y="177.9922"/><rect fill="none" height="294.1328" style="stroke:#000000;stroke-width:1.5;" width="996.0098" x="230.2031" y="318.6563"/><rect fill="none" height="164.7969" style="stroke:#000000;stroke-width:1.5;" width="886.0049" x="350.208" y="823.3906"/><rect fill="none" height="133.6641" style="stroke:#000000;stroke-width:1.5;" width="866.0049" x="360.208" y="847.5234"/><rect fill="none" height="514.8672" style="stroke:#000000;stroke-width:1.5;" width="1301.3115" x="10" y="1788.7734"/><rect fill="none" height="294.1328" style="stroke:#000000;stroke-width:1.5;" width="1281.3115" x="20" y="2002.5078"/><g><title>Client Side</title><rect fill="#000000" fill-opacity="0.00000" height="2247.0469" width="8" x="70.6284" y="73.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="74" x2="74" y1="73.5938" y2="2320.6406"/></g><g><title>Embedding API</title><rect fill="#000000" fill-opacity="0.00000" height="2247.0469" width="8" x="296.2056" y="73.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="300.2031" x2="300.2031" y1="73.5938" y2="2320.6406"/></g><g><title>Chat API</title><rect fill="#000000" fill-opacity="0.00000" height="2247.0469" width="8" x="402.8657" y="73.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="406.208" x2="406.208" y1="73.5938" y2="2320.6406"/></g><g><title>Review Summary API</title><rect fill="#000000" fill-opacity="0.00000" height="2247.0469" width="8" x="531.165" y="73.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="534.5234" x2="534.5234" y1="73.5938" y2="2320.6406"/></g><g><title>AI Utility</title><rect fill="#000000" fill-opacity="0.00000" height="2247.0469" width="8" x="806.1333" y="73.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="809.4653" x2="809.4653" y1="73.5938" y2="2320.6406"/></g><g><title>Database Utility</title><rect fill="#000000" fill-opacity="0.00000" height="2247.0469" width="8" x="916.0166" y="73.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="919.8013" x2="919.8013" y1="73.5938" y2="2320.6406"/></g><g><title>Auth Utility</title><rect fill="#000000" fill-opacity="0.00000" height="2247.0469" width="8" x="1035.4531" y="73.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1039.2319" x2="1039.2319" y1="73.5938" y2="2320.6406"/></g><g><title>Supabase</title><rect fill="#000000" fill-opacity="0.00000" height="2247.0469" width="8" x="1170.9136" y="73.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1174.6143" x2="1174.6143" y1="73.5938" y2="2320.6406"/></g><g><title>OpenAI</title><rect fill="#000000" fill-opacity="0.00000" height="2247.0469" width="8" x="1254.7622" y="73.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1258.2129" x2="1258.2129" y1="73.5938" y2="2320.6406"/></g><g class="participant participant-head" data-participant="Client"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="89.2568" x="30" y="42.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75.2568" x="37" y="62.292">Client Side</text></g><g class="participant participant-tail" data-participant="Client"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="89.2568" x="30" y="2319.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75.2568" x="37" y="2339.6357">Client Side</text></g><g class="participant participant-head" data-participant="EmbedAPI"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="120.0049" x="240.2031" y="42.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106.0049" x="247.2031" y="62.292">Embedding API</text></g><g class="participant participant-tail" data-participant="EmbedAPI"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="120.0049" x="240.2031" y="2319.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106.0049" x="247.2031" y="2339.6357">Embedding API</text></g><g class="participant participant-head" data-participant="ChatAPI"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73.3154" x="370.208" y="42.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.3154" x="377.208" y="62.292">Chat API</text></g><g class="participant participant-tail" data-participant="ChatAPI"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73.3154" x="370.208" y="2319.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.3154" x="377.208" y="2339.6357">Chat API</text></g><g class="participant participant-head" data-participant="SummaryAPI"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="163.2832" x="453.5234" y="42.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="149.2832" x="460.5234" y="62.292">Review Summary API</text></g><g class="participant participant-tail" data-participant="SummaryAPI"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="163.2832" x="453.5234" y="2319.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="149.2832" x="460.5234" y="2339.6357">Review Summary API</text></g><g class="participant participant-head" data-participant="AIUtil"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73.3359" x="773.4653" y="42.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.3359" x="780.4653" y="62.292">AI Utility</text></g><g class="participant participant-tail" data-participant="AIUtil"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73.3359" x="773.4653" y="2319.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.3359" x="780.4653" y="2339.6357">AI Utility</text></g><g class="participant participant-head" data-participant="DBUtil"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="126.4307" x="856.8013" y="42.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112.4307" x="863.8013" y="62.292">Database Utility</text></g><g class="participant participant-tail" data-participant="DBUtil"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="126.4307" x="856.8013" y="2319.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112.4307" x="863.8013" y="2339.6357">Database Utility</text></g><g class="participant participant-head" data-participant="AuthUtil"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="92.4424" x="993.2319" y="42.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78.4424" x="1000.2319" y="62.292">Auth Utility</text></g><g class="participant participant-tail" data-participant="AuthUtil"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="92.4424" x="993.2319" y="2319.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78.4424" x="1000.2319" y="2339.6357">Auth Utility</text></g><g class="participant participant-head" data-participant="Supabase"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="82.5986" x="1133.6143" y="42.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68.5986" x="1140.6143" y="62.292">Supabase</text></g><g class="participant participant-tail" data-participant="Supabase"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="82.5986" x="1133.6143" y="2319.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68.5986" x="1140.6143" y="2339.6357">Supabase</text></g><g class="participant participant-head" data-participant="OpenAI"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.0986" x="1226.2129" y="42.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.0986" x="1233.2129" y="62.292">OpenAI</text></g><g class="participant participant-tail" data-participant="OpenAI"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.0986" x="1226.2129" y="2319.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.0986" x="1233.2129" y="2339.6357">OpenAI</text></g><g class="message" data-participant-1="Client" data-participant-2="EmbedAPI"><polygon fill="#181818" points="288.2056,100.7266,298.2056,104.7266,288.2056,108.7266,292.2056,104.7266" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="74.6284" x2="294.2056" y1="104.7266" y2="104.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="81.6284" y="99.6606">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188.5317" x="94.6738" y="99.6606">Request embedding creation</text></g><g class="message" data-participant-1="EmbedAPI" data-participant-2="AuthUtil"><polygon fill="#181818" points="1027.4531,129.8594,1037.4531,133.8594,1027.4531,137.8594,1031.4531,133.8594" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="300.2056" x2="1033.4531" y1="133.8594" y2="133.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="307.2056" y="128.7935">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197.5073" x="320.251" y="128.7935">Validate request authorization</text></g><g class="message" data-participant-1="AuthUtil" data-participant-2="EmbedAPI"><polygon fill="#181818" points="311.2056,158.9922,301.2056,162.9922,311.2056,166.9922,307.2056,162.9922" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="305.2056" x2="1038.4531" y1="162.9922" y2="162.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="317.2056" y="157.9263">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121.7036" x="330.251" y="157.9263">Return auth status</text></g><path d="M20,177.9922 L84.4429,177.9922 L84.4429,185.125 L74.4429,195.125 L20,195.125 L20,177.9922" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="544" style="stroke:#000000;stroke-width:1.5;" width="1281.3115" x="20" y="177.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="35" y="191.0591">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="128.5732" x="99.4429" y="190.2026">[authorized request]</text><g class="message" data-participant-1="EmbedAPI" data-participant-2="AIUtil"><polygon fill="#181818" points="798.1333,212.2578,808.1333,216.2578,798.1333,220.2578,802.1333,216.2578" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="300.2056" x2="804.1333" y1="216.2578" y2="216.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="307.2056" y="211.1919">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168.6572" x="320.251" y="211.1919">generateEmbedding(text)</text></g><g class="message" data-participant-1="AIUtil" data-participant-2="OpenAI"><polygon fill="#181818" points="1246.7622,241.3906,1256.7622,245.3906,1246.7622,249.3906,1250.7622,245.3906" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="810.1333" x2="1252.7622" y1="245.3906" y2="245.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="817.1333" y="240.3247">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166.499" x="830.1787" y="240.3247">Create embedding vector</text></g><g class="message" data-participant-1="OpenAI" data-participant-2="AIUtil"><polygon fill="#181818" points="821.1333,270.5234,811.1333,274.5234,821.1333,278.5234,817.1333,274.5234" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="815.1333" x2="1257.7622" y1="274.5234" y2="274.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="827.1333" y="269.4575">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121.6021" x="840.1787" y="269.4575">Return embedding</text></g><g class="message" data-participant-1="AIUtil" data-participant-2="EmbedAPI"><polygon fill="#181818" points="311.2056,299.6563,301.2056,303.6563,311.2056,307.6563,307.2056,303.6563" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="305.2056" x2="809.1333" y1="303.6563" y2="303.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="317.2056" y="298.5903">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166.9688" x="330.251" y="298.5903">Return embedding vector</text></g><path d="M230.2031,318.6563 L294.646,318.6563 L294.646,325.7891 L284.646,335.7891 L230.2031,335.7891 L230.2031,318.6563" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="294.1328" style="stroke:#000000;stroke-width:1.5;" width="996.0098" x="230.2031" y="318.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="245.2031" y="331.7231">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="108.7056" x="309.646" y="330.8667">[type is "review"]</text><g class="message" data-participant-1="EmbedAPI" data-participant-2="DBUtil"><polygon fill="#181818" points="908.0166,352.9219,918.0166,356.9219,908.0166,360.9219,912.0166,356.9219" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="300.2056" x2="914.0166" y1="356.9219" y2="356.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="307.2056" y="351.856">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="301.1582" x="320.251" y="351.856">storeReviewEmbedding(reviewId, embedding)</text></g><g class="message" data-participant-1="DBUtil" data-participant-2="Supabase"><polygon fill="#181818" points="1162.9136,382.0547,1172.9136,386.0547,1162.9136,390.0547,1166.9136,386.0547" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="920.0166" x2="1168.9136" y1="386.0547" y2="386.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="927.0166" y="380.9888">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183.2949" x="940.062" y="380.9888">Save to review_embeddings</text></g><g class="message" data-participant-1="Supabase" data-participant-2="DBUtil"><polygon fill="#181818" points="931.0166,411.1875,921.0166,415.1875,931.0166,419.1875,927.0166,415.1875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="925.0166" x2="1173.9136" y1="415.1875" y2="415.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="937.0166" y="410.1216">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104.9839" x="959.1074" y="410.1216">Confirm storage</text></g><g class="message" data-participant-1="EmbedAPI" data-participant-2="DBUtil"><polygon fill="#181818" points="908.0166,440.3203,918.0166,444.3203,908.0166,448.3203,912.0166,444.3203" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="300.2056" x2="914.0166" y1="444.3203" y2="444.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="307.2056" y="439.2544">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="225.6084" x="329.2964" y="439.2544">markSummaryForUpdate(listingId)</text></g><g class="message" data-participant-1="DBUtil" data-participant-2="Supabase"><polygon fill="#181818" points="1162.9136,469.4531,1172.9136,473.4531,1162.9136,477.4531,1166.9136,473.4531" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="920.0166" x2="1168.9136" y1="473.4531" y2="473.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="927.0166" y="468.3872">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168.9429" x="949.1074" y="468.3872">Update listing_summaries</text></g><g class="message" data-participant-1="Supabase" data-participant-2="DBUtil"><polygon fill="#181818" points="931.0166,498.5859,921.0166,502.5859,931.0166,506.5859,927.0166,502.5859" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="925.0166" x2="1173.9136" y1="502.5859" y2="502.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="937.0166" y="497.52">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101.4038" x="959.1074" y="497.52">Confirm update</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="230.2031" x2="1226.2129" y1="511.5859" y2="511.5859"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="106.0791" x="235.2031" y="521.7964">[type is "listing"]</text><g class="message" data-participant-1="EmbedAPI" data-participant-2="DBUtil"><polygon fill="#181818" points="908.0166,542.5234,918.0166,546.5234,908.0166,550.5234,912.0166,546.5234" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="300.2056" x2="914.0166" y1="546.5234" y2="546.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="307.2056" y="541.4575">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="292.938" x="329.2964" y="541.4575">storeListingEmbedding(listingId, embedding)</text></g><g class="message" data-participant-1="DBUtil" data-participant-2="Supabase"><polygon fill="#181818" points="1162.9136,571.6563,1172.9136,575.6563,1162.9136,579.6563,1166.9136,575.6563" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="920.0166" x2="1168.9136" y1="575.6563" y2="575.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="927.0166" y="570.5903">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179.2134" x="949.1074" y="570.5903">Save to listing_embeddings</text></g><g class="message" data-participant-1="Supabase" data-participant-2="DBUtil"><polygon fill="#181818" points="931.0166,600.7891,921.0166,604.7891,931.0166,608.7891,927.0166,604.7891" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="925.0166" x2="1173.9136" y1="604.7891" y2="604.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="937.0166" y="599.7231">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104.9839" x="959.1074" y="599.7231">Confirm storage</text></g><g class="message" data-participant-1="DBUtil" data-participant-2="EmbedAPI"><polygon fill="#181818" points="311.2056,636.9219,301.2056,640.9219,311.2056,644.9219,307.2056,640.9219" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="305.2056" x2="919.0166" y1="640.9219" y2="640.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="317.2056" y="635.856">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98.9346" x="339.2964" y="635.856">Return success</text></g><g class="message" data-participant-1="EmbedAPI" data-participant-2="Client"><polygon fill="#181818" points="85.6284,666.0547,75.6284,670.0547,85.6284,674.0547,81.6284,670.0547" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="79.6284" x2="299.2056" y1="670.0547" y2="670.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="91.6284" y="664.9888">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162.3984" x="113.7192" y="664.9888">Return success response</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="20" x2="1301.3115" y1="679.0547" y2="679.0547"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="92.5493" x="25" y="689.2651">[unauthorized]</text><g class="message" data-participant-1="EmbedAPI" data-participant-2="Client"><polygon fill="#181818" points="85.6284,709.9922,75.6284,713.9922,85.6284,717.9922,81.6284,713.9922" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="79.6284" x2="299.2056" y1="713.9922" y2="713.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="91.6284" y="708.9263">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.0146" x="113.7192" y="708.9263">Return 401 error</text></g><g class="message" data-participant-1="Client" data-participant-2="ChatAPI"><polygon fill="#181818" points="394.8657,746.125,404.8657,750.125,394.8657,754.125,398.8657,750.125" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="74.6284" x2="400.8657" y1="750.125" y2="750.125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="81.6284" y="745.0591">20</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="232.6226" x="103.7192" y="745.0591">Send message with session context</text></g><g class="message" data-participant-1="ChatAPI" data-participant-2="AuthUtil"><polygon fill="#181818" points="1027.4531,775.2578,1037.4531,779.2578,1027.4531,783.2578,1031.4531,779.2578" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="406.8657" x2="1033.4531" y1="779.2578" y2="779.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="413.8657" y="774.1919">21</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133.1929" x="435.9565" y="774.1919">Check session token</text></g><g class="message" data-participant-1="AuthUtil" data-participant-2="ChatAPI"><polygon fill="#181818" points="417.8657,804.3906,407.8657,808.3906,417.8657,812.3906,413.8657,808.3906" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="411.8657" x2="1038.4531" y1="808.3906" y2="808.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="423.8657" y="803.3247">22</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121.7036" x="445.9565" y="803.3247">Return auth status</text></g><path d="M350.208,823.3906 L414.6509,823.3906 L414.6509,830.5234 L404.6509,840.5234 L350.208,840.5234 L350.208,823.3906" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="164.7969" style="stroke:#000000;stroke-width:1.5;" width="886.0049" x="350.208" y="823.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="365.208" y="836.4575">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="156.4009" x="429.6509" y="835.6011">[session ID is temporary]</text><path d="M360.208,847.5234 L424.6509,847.5234 L424.6509,854.6563 L414.6509,864.6563 L360.208,864.6563 L360.208,847.5234" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="133.6641" style="stroke:#000000;stroke-width:1.5;" width="866.0049" x="360.208" y="847.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="375.208" y="860.5903">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="128.3477" x="439.6509" y="859.7339">[user authenticated]</text><g class="message" data-participant-1="ChatAPI" data-participant-2="DBUtil"><polygon fill="#181818" points="908.0166,881.7891,918.0166,885.7891,908.0166,889.7891,912.0166,885.7891" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="406.8657" x2="914.0166" y1="885.7891" y2="885.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="413.8657" y="880.7231">23</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="206.5083" x="435.9565" y="880.7231">createPersistentSession(userId)</text></g><g class="message" data-participant-1="DBUtil" data-participant-2="Supabase"><polygon fill="#181818" points="1162.9136,910.9219,1172.9136,914.9219,1162.9136,918.9219,1166.9136,914.9219" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="920.0166" x2="1168.9136" y1="914.9219" y2="914.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="927.0166" y="909.856">24</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128.3179" x="949.1074" y="909.856">Create chat session</text></g><g class="message" data-participant-1="Supabase" data-participant-2="DBUtil"><polygon fill="#181818" points="931.0166,940.0547,921.0166,944.0547,931.0166,948.0547,927.0166,944.0547" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="925.0166" x2="1173.9136" y1="944.0547" y2="944.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="937.0166" y="938.9888">25</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.1836" x="959.1074" y="938.9888">Return new session ID</text></g><g class="message" data-participant-1="DBUtil" data-participant-2="ChatAPI"><polygon fill="#181818" points="417.8657,969.1875,407.8657,973.1875,417.8657,977.1875,413.8657,973.1875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="411.8657" x2="919.0166" y1="973.1875" y2="973.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="423.8657" y="968.1216">26</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114.1816" x="445.9565" y="968.1216">Return session ID</text></g><g class="message" data-participant-1="ChatAPI" data-participant-2="DBUtil"><polygon fill="#181818" points="908.0166,1012.3203,918.0166,1016.3203,908.0166,1020.3203,912.0166,1016.3203" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="406.8657" x2="914.0166" y1="1016.3203" y2="1016.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="413.8657" y="1011.2544">27</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="273.0254" x="435.9565" y="1011.2544">saveMessage(sessionId, "user", message)</text></g><g class="message" data-participant-1="DBUtil" data-participant-2="Supabase"><polygon fill="#181818" points="1162.9136,1041.4531,1172.9136,1045.4531,1162.9136,1049.4531,1166.9136,1045.4531" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="920.0166" x2="1168.9136" y1="1045.4531" y2="1045.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="927.0166" y="1040.3872">28</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97.2017" x="949.1074" y="1040.3872">Store message</text></g><g class="message" data-participant-1="Supabase" data-participant-2="DBUtil"><polygon fill="#181818" points="931.0166,1070.5859,921.0166,1074.5859,931.0166,1078.5859,927.0166,1074.5859" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="925.0166" x2="1173.9136" y1="1074.5859" y2="1074.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="937.0166" y="1069.52">29</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104.9839" x="959.1074" y="1069.52">Confirm storage</text></g><g class="message" data-participant-1="ChatAPI" data-participant-2="AIUtil"><polygon fill="#181818" points="798.1333,1099.7188,808.1333,1103.7188,798.1333,1107.7188,802.1333,1103.7188" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="406.8657" x2="804.1333" y1="1103.7188" y2="1103.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="413.8657" y="1098.6528">30</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="194.0288" x="435.9565" y="1098.6528">getChatEmbedding(message)</text></g><g class="message" data-participant-1="AIUtil" data-participant-2="OpenAI"><polygon fill="#181818" points="1246.7622,1128.8516,1256.7622,1132.8516,1246.7622,1136.8516,1250.7622,1132.8516" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="810.1333" x2="1252.7622" y1="1132.8516" y2="1132.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="817.1333" y="1127.7856">31</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166.499" x="839.2241" y="1127.7856">Create embedding vector</text></g><g class="message" data-participant-1="OpenAI" data-participant-2="AIUtil"><polygon fill="#181818" points="821.1333,1157.9844,811.1333,1161.9844,821.1333,1165.9844,817.1333,1161.9844" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="815.1333" x2="1257.7622" y1="1161.9844" y2="1161.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="827.1333" y="1156.9185">32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121.6021" x="849.2241" y="1156.9185">Return embedding</text></g><g class="message" data-participant-1="AIUtil" data-participant-2="ChatAPI"><polygon fill="#181818" points="417.8657,1187.1172,407.8657,1191.1172,417.8657,1195.1172,413.8657,1191.1172" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="411.8657" x2="809.1333" y1="1191.1172" y2="1191.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="423.8657" y="1186.0513">33</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163.2617" x="445.9565" y="1186.0513">Return query embedding</text></g><g class="message" data-participant-1="ChatAPI" data-participant-2="DBUtil"><polygon fill="#181818" points="908.0166,1216.25,918.0166,1220.25,908.0166,1224.25,912.0166,1220.25" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="406.8657" x2="914.0166" y1="1220.25" y2="1220.25"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="413.8657" y="1215.1841">34</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="215.5791" x="435.9565" y="1215.1841">findRelevantListings(embedding)</text></g><g class="message" data-participant-1="DBUtil" data-participant-2="Supabase"><polygon fill="#181818" points="1162.9136,1245.3828,1172.9136,1249.3828,1162.9136,1253.3828,1166.9136,1249.3828" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="920.0166" x2="1168.9136" y1="1249.3828" y2="1249.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="927.0166" y="1244.3169">35</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208.8062" x="949.1074" y="1244.3169">Perform vector similarity search</text></g><g class="message" data-participant-1="Supabase" data-participant-2="DBUtil"><polygon fill="#181818" points="931.0166,1274.5156,921.0166,1278.5156,931.0166,1282.5156,927.0166,1278.5156" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="925.0166" x2="1173.9136" y1="1278.5156" y2="1278.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="937.0166" y="1273.4497">36</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="152.1343" x="959.1074" y="1273.4497">Return relevant listings</text></g><g class="message" data-participant-1="DBUtil" data-participant-2="ChatAPI"><polygon fill="#181818" points="417.8657,1303.6484,407.8657,1307.6484,417.8657,1311.6484,413.8657,1307.6484" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="411.8657" x2="919.0166" y1="1307.6484" y2="1307.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="423.8657" y="1302.5825">37</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147.4116" x="445.9565" y="1302.5825">Return context listings</text></g><g class="message" data-participant-1="ChatAPI" data-participant-2="DBUtil"><polygon fill="#181818" points="908.0166,1332.7813,918.0166,1336.7813,908.0166,1340.7813,912.0166,1336.7813" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="406.8657" x2="914.0166" y1="1336.7813" y2="1336.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="413.8657" y="1331.7153">38</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="218.3975" x="435.9565" y="1331.7153">findSimilarListings(mentionedIds)</text></g><g class="message" data-participant-1="DBUtil" data-participant-2="Supabase"><polygon fill="#181818" points="1162.9136,1361.9141,1172.9136,1365.9141,1162.9136,1369.9141,1166.9136,1365.9141" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="920.0166" x2="1168.9136" y1="1365.9141" y2="1365.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="927.0166" y="1360.8481">39</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137.3252" x="949.1074" y="1360.8481">Query similar listings</text></g><g class="message" data-participant-1="Supabase" data-participant-2="DBUtil"><polygon fill="#181818" points="931.0166,1391.0469,921.0166,1395.0469,931.0166,1399.0469,927.0166,1395.0469" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="925.0166" x2="1173.9136" y1="1395.0469" y2="1395.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="937.0166" y="1389.981">40</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.7686" x="959.1074" y="1389.981">Return similar listings</text></g><g class="message" data-participant-1="DBUtil" data-participant-2="ChatAPI"><polygon fill="#181818" points="417.8657,1420.1797,407.8657,1424.1797,417.8657,1428.1797,413.8657,1424.1797" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="411.8657" x2="919.0166" y1="1424.1797" y2="1424.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="423.8657" y="1419.1138">41</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144.4536" x="445.9565" y="1419.1138">Return related listings</text></g><g class="message" data-participant-1="ChatAPI" data-participant-2="AIUtil"><polygon fill="#181818" points="798.1333,1449.3125,808.1333,1453.3125,798.1333,1457.3125,802.1333,1453.3125" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="406.8657" x2="804.1333" y1="1453.3125" y2="1453.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="413.8657" y="1448.2466">42</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="331.3286" x="435.9565" y="1448.2466">generateChatResponse(message, context, history)</text></g><g class="message" data-participant-1="AIUtil" data-participant-2="OpenAI"><polygon fill="#181818" points="1246.7622,1478.4453,1256.7622,1482.4453,1246.7622,1486.4453,1250.7622,1482.4453" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="810.1333" x2="1252.7622" y1="1482.4453" y2="1482.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="817.1333" y="1477.3794">43</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.0386" x="839.2241" y="1477.3794">Generate AI response</text></g><g class="message" data-participant-1="OpenAI" data-participant-2="AIUtil"><polygon fill="#181818" points="821.1333,1507.5781,811.1333,1511.5781,821.1333,1515.5781,817.1333,1511.5781" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="815.1333" x2="1257.7622" y1="1511.5781" y2="1511.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="827.1333" y="1506.5122">44</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137.4331" x="849.2241" y="1506.5122">Return response text</text></g><g class="message" data-participant-1="AIUtil" data-participant-2="ChatAPI"><polygon fill="#181818" points="417.8657,1536.7109,407.8657,1540.7109,417.8657,1544.7109,413.8657,1540.7109" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="411.8657" x2="809.1333" y1="1540.7109" y2="1540.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="423.8657" y="1535.645">45</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176.4966" x="445.9565" y="1535.645">Return formatted response</text></g><g class="message" data-participant-1="ChatAPI" data-participant-2="DBUtil"><polygon fill="#181818" points="908.0166,1565.8438,918.0166,1569.8438,908.0166,1573.8438,912.0166,1569.8438" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="406.8657" x2="914.0166" y1="1569.8438" y2="1569.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="413.8657" y="1564.7778">46</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="266.8809" x="435.9565" y="1564.7778">saveMessage(sessionId, "bot", response)</text></g><g class="message" data-participant-1="DBUtil" data-participant-2="Supabase"><polygon fill="#181818" points="1162.9136,1594.9766,1172.9136,1598.9766,1162.9136,1602.9766,1166.9136,1598.9766" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="920.0166" x2="1168.9136" y1="1598.9766" y2="1598.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="927.0166" y="1593.9106">47</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97.2017" x="949.1074" y="1593.9106">Store message</text></g><g class="message" data-participant-1="Supabase" data-participant-2="DBUtil"><polygon fill="#181818" points="931.0166,1624.1094,921.0166,1628.1094,931.0166,1632.1094,927.0166,1628.1094" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="925.0166" x2="1173.9136" y1="1628.1094" y2="1628.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="937.0166" y="1623.0435">48</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104.9839" x="959.1074" y="1623.0435">Confirm storage</text></g><g class="message" data-participant-1="ChatAPI" data-participant-2="Client"><polygon fill="#181818" points="85.6284,1653.2422,75.6284,1657.2422,85.6284,1661.2422,81.6284,1657.2422" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="79.6284" x2="405.8657" y1="1657.2422" y2="1657.2422"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="91.6284" y="1652.1763">49</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="206.2354" x="113.7192" y="1652.1763">Return response and session ID</text></g><g class="message" data-participant-1="Client" data-participant-2="SummaryAPI"><polygon fill="#181818" points="523.165,1682.375,533.165,1686.375,523.165,1690.375,527.165,1686.375" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="74.6284" x2="529.165" y1="1686.375" y2="1686.375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="81.6284" y="1681.3091">50</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166.2769" x="103.7192" y="1681.3091">Request review summary</text></g><g class="message" data-participant-1="SummaryAPI" data-participant-2="DBUtil"><polygon fill="#181818" points="908.0166,1711.5078,918.0166,1715.5078,908.0166,1719.5078,912.0166,1715.5078" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="535.165" x2="914.0166" y1="1715.5078" y2="1715.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="542.165" y="1710.4419">51</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="213.8018" x="564.2559" y="1710.4419">checkExistingSummary(listingId)</text></g><g class="message" data-participant-1="DBUtil" data-participant-2="Supabase"><polygon fill="#181818" points="1162.9136,1740.6406,1172.9136,1744.6406,1162.9136,1748.6406,1166.9136,1744.6406" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="920.0166" x2="1168.9136" y1="1744.6406" y2="1744.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="927.0166" y="1739.5747">52</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151.1567" x="949.1074" y="1739.5747">Query summary record</text></g><g class="message" data-participant-1="Supabase" data-participant-2="DBUtil"><polygon fill="#181818" points="931.0166,1769.7734,921.0166,1773.7734,931.0166,1777.7734,927.0166,1773.7734" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="925.0166" x2="1173.9136" y1="1773.7734" y2="1773.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="937.0166" y="1768.7075">53</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142.8413" x="959.1074" y="1768.7075">Return summary data</text></g><path d="M10,1788.7734 L74.4429,1788.7734 L74.4429,1795.9063 L64.4429,1805.9063 L10,1805.9063 L10,1788.7734" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="514.8672" style="stroke:#000000;stroke-width:1.5;" width="1301.3115" x="10" y="1788.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="25" y="1801.8403">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="141.7217" x="89.4429" y="1800.9839">[valid summary exists]</text><g class="message" data-participant-1="DBUtil" data-participant-2="SummaryAPI"><polygon fill="#181818" points="546.165,1823.0391,536.165,1827.0391,546.165,1831.0391,542.165,1827.0391" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="540.165" x2="919.0166" y1="1827.0391" y2="1827.0391"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="552.165" y="1821.9731">54</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160.3101" x="574.2559" y="1821.9731">Return cached summary</text></g><g class="message" data-participant-1="SummaryAPI" data-participant-2="Client"><polygon fill="#181818" points="85.6284,1852.1719,75.6284,1856.1719,85.6284,1860.1719,81.6284,1856.1719" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="79.6284" x2="534.165" y1="1856.1719" y2="1856.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="91.6284" y="1851.106">55</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164.8359" x="113.7192" y="1851.106">Return existing summary</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="10" x2="1311.3115" y1="1865.1719" y2="1865.1719"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="131.1138" x="15" y="1875.3823">[need new summary]</text><g class="message" data-participant-1="SummaryAPI" data-participant-2="DBUtil"><polygon fill="#181818" points="908.0166,1896.1094,918.0166,1900.1094,908.0166,1904.1094,912.0166,1900.1094" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="535.165" x2="914.0166" y1="1900.1094" y2="1900.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="542.165" y="1895.0435">56</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179.3403" x="564.2559" y="1895.0435">getListingReviews(listingId)</text></g><g class="message" data-participant-1="DBUtil" data-participant-2="Supabase"><polygon fill="#181818" points="1162.9136,1925.2422,1172.9136,1929.2422,1162.9136,1933.2422,1166.9136,1929.2422" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="920.0166" x2="1168.9136" y1="1929.2422" y2="1929.2422"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="927.0166" y="1924.1763">57</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93.6914" x="949.1074" y="1924.1763">Query reviews</text></g><g class="message" data-participant-1="Supabase" data-participant-2="DBUtil"><polygon fill="#181818" points="931.0166,1954.375,921.0166,1958.375,931.0166,1962.375,927.0166,1958.375" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="925.0166" x2="1173.9136" y1="1958.375" y2="1958.375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="937.0166" y="1953.3091">58</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.7759" x="959.1074" y="1953.3091">Return review data</text></g><g class="message" data-participant-1="DBUtil" data-participant-2="SummaryAPI"><polygon fill="#181818" points="546.165,1983.5078,536.165,1987.5078,546.165,1991.5078,542.165,1987.5078" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="540.165" x2="919.0166" y1="1987.5078" y2="1987.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="552.165" y="1982.4419">59</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98.1348" x="574.2559" y="1982.4419">Return reviews</text></g><path d="M20,2002.5078 L84.4429,2002.5078 L84.4429,2009.6406 L74.4429,2019.6406 L20,2019.6406 L20,2002.5078" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="294.1328" style="stroke:#000000;stroke-width:1.5;" width="1281.3115" x="20" y="2002.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="35" y="2015.5747">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="117.9653" x="99.4429" y="2014.7183">[reviews available]</text><g class="message" data-participant-1="SummaryAPI" data-participant-2="AIUtil"><polygon fill="#181818" points="798.1333,2036.7734,808.1333,2040.7734,798.1333,2044.7734,802.1333,2040.7734" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="535.165" x2="804.1333" y1="2040.7734" y2="2040.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="542.165" y="2035.7075">60</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="228.8774" x="564.2559" y="2035.7075">generateReviewSummary(reviews)</text></g><g class="message" data-participant-1="AIUtil" data-participant-2="OpenAI"><polygon fill="#181818" points="1246.7622,2065.9063,1256.7622,2069.9063,1246.7622,2073.9063,1250.7622,2069.9063" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="810.1333" x2="1252.7622" y1="2069.9063" y2="2069.9063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="817.1333" y="2064.8403">61</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151.144" x="839.2241" y="2064.8403">Process review content</text></g><g class="message" data-participant-1="OpenAI" data-participant-2="AIUtil"><polygon fill="#181818" points="821.1333,2095.0391,811.1333,2099.0391,821.1333,2103.0391,817.1333,2099.0391" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="815.1333" x2="1257.7622" y1="2099.0391" y2="2099.0391"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="827.1333" y="2093.9731">62</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208.0889" x="849.2241" y="2093.9731">Return summary with pros/cons</text></g><g class="message" data-participant-1="AIUtil" data-participant-2="SummaryAPI"><polygon fill="#181818" points="546.165,2124.1719,536.165,2128.1719,546.165,2132.1719,542.165,2128.1719" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="540.165" x2="809.1333" y1="2128.1719" y2="2128.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="552.165" y="2123.106">63</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181.0923" x="574.2559" y="2123.106">Return structured summary</text></g><g class="message" data-participant-1="SummaryAPI" data-participant-2="DBUtil"><polygon fill="#181818" points="908.0166,2153.3047,918.0166,2157.3047,908.0166,2161.3047,912.0166,2157.3047" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="535.165" x2="914.0166" y1="2157.3047" y2="2157.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="542.165" y="2152.2388">64</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="227.0239" x="564.2559" y="2152.2388">storeSummary(listingId, summary)</text></g><g class="message" data-participant-1="DBUtil" data-participant-2="Supabase"><polygon fill="#181818" points="1162.9136,2182.4375,1172.9136,2186.4375,1162.9136,2190.4375,1166.9136,2186.4375" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="920.0166" x2="1168.9136" y1="2186.4375" y2="2186.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="927.0166" y="2181.3716">65</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="170.9551" x="949.1074" y="2181.3716">Save to listing_summaries</text></g><g class="message" data-participant-1="Supabase" data-participant-2="DBUtil"><polygon fill="#181818" points="931.0166,2211.5703,921.0166,2215.5703,931.0166,2219.5703,927.0166,2215.5703" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="925.0166" x2="1173.9136" y1="2215.5703" y2="2215.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="937.0166" y="2210.5044">66</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104.9839" x="959.1074" y="2210.5044">Confirm storage</text></g><g class="message" data-participant-1="SummaryAPI" data-participant-2="Client"><polygon fill="#181818" points="85.6284,2240.7031,75.6284,2244.7031,85.6284,2248.7031,81.6284,2244.7031" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="79.6284" x2="534.165" y1="2244.7031" y2="2244.7031"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="91.6284" y="2239.6372">67</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.7051" x="113.7192" y="2239.6372">Return generated summary</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="20" x2="1301.3115" y1="2253.7031" y2="2253.7031"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="77.2686" x="25" y="2263.9136">[no reviews]</text><g class="message" data-participant-1="SummaryAPI" data-participant-2="Client"><polygon fill="#181818" points="85.6284,2284.6406,75.6284,2288.6406,85.6284,2292.6406,81.6284,2288.6406" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="79.6284" x2="534.165" y1="2288.6406" y2="2288.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="91.6284" y="2283.5747">68</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155.2637" x="113.7192" y="2283.5747">Return empty summary</text></g><!--SRC=[hLVBRjj65DtFLmoqYGmeQ0DqfKK1LKe20YtgIaYtmPYybWOcPvYPeHpbwtFdoQSe6QqNDaMT-pxtOSDD2NJpcD6zR0neUe1l3OWSw8wpes8LNUv0ywEWZoUcuO6mnaZHL4-W2AcPCZpdDHE6RaiE-8TfkWYF1rx0eeVvY6A5jMLHxaF1nT5Qx-Es9sOYp3wF4OUcgfYwHD0UpXnUuzinV9DzCRnqq4r6xJCtbpvazqU2x9XXJnZiD73Jc5Eh3JzCmmvDxPJqNlvTWzXaXBoZRVIVGO1YXalXol2fbAyaPF3zxobbQxgtXT66GfBC5JWvalAA0j6zDVsNbRnW1gWAabYwarJyXnTASRmVc36D4WvBjM6cqOImiXM68keZ57zwfZDl-EWZWXJZqi1ty-3meHA8zhbOqwsD0ZfXdI4tKZcqnpWFe_BWNuBtj4v5CgdO_R9XcKiDb6CbbQFGmdqn3CnpOutva0eyrzhOl61Mh5fB3qbBO1NgY7nOqmCx0pMIUi6lIKedgOXr0KNZMocUkQgS4-m82JphCRR3I-YAJr9zgIqVbYNN1krbnRoV7aq3-gjsQZZSwMRZf1qMIiIaH0TzTsJwJuziKvqSVtEkOn3_9TaWYfOxqTWKutIJvw3re3yGwTjwY4CYw5eA71KkKOreM-scYjz-_K11AMIrzGxdIXoNmpaIHYfc186qGhCO5dtbjilnWvq-kHIsJmc9uxStJROdo5yIriWN68oGPE7Q18cosSxom41LOsxL9RLYeq4vANIPvqYU8jMeur6ia1j-y0XAOsbHuk2rBwsMMymE8oUtkGfUpTCXX2HmnxHHZ4nC9660jaKAXNBCT267Of2983M2_l9VBuCgI_w5bLkiekG3cQI-RQ6a_2wMerkFIZfEzXY2AwlBYJJcZNtRjcTov_uXVy-0xmptONfn3-6wRw4Om6SmaSdqMIfNvAdKFdDHxA64C-xbC6ZqiZDLfbAAR4ELLN2UQbxn4aUYkM2TcSfFP8uyAXYBiqYJ6Tx421BsMWW7xqEAeBBD8mKKMQ6dW_Z7vIputXgOStq4dl4SmxIjs_7yNJnne9rqatJo8FlLFk0YfLOn8IjwufQjbocI9JF8g6JfEiCYXBgfDyCoMtDcZBjyWjROm4_IJ0Prgu5H3litIlv_3PnS6A-A52x31T2PInZA-7mUhe_stcuFKN-_K7yNN0ZftEJTEMttniVldWq1qhr0PYWQt56GIrNC4pH0yUHWVjcSxV6RteErhuUBkn-Kxpk6_YOvuXT26zOugn0YIo9kXmj09QAJdA6YDWASeg5vVHNqy3oxdY1V04rkhQrGA9USsodeQasxERoaxCnm4ZoLqDcNtQY6pUnZYcKFMjhbFExXk7-2pwxjXKa2rxivbjejh5f9_GlAwf6bwPYrKKsEJuFIzyxhwVAvGtL4wrLKyxRhz8qdzjN_1EOf6slJZzNpLlRAVmVzgzfS-dhyYVCJ]--></g></svg>